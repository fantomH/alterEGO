#!/usr/bin/env sh

## { alterEGO Linux: "Open the vault of knowledge" }---------------------------
##
## .egorc
##   created     : 2021-03-19 09:37:19 UTC
##   updated     : 2021-09-08 12:15:33 UTC
##   description : Additional shell stuff for alterEGO Linux.
##   app         : sh
##   target      : ${HOME}/.alterEGO/.egorc
## ____________________________________________________________________________

  alias msfconsole='msfconsole -x "db_connect ${USER}@msf"'

## [ WORDLISTS ]
  export WORDLIST="/usr/local/share/wordlist"
  export WL_BEST1050="${WORDLIST}/best1050.txt"
  export WL_BIG="${WORDLIST}/seclist-big.txt"
  export WL_DIRMEDIUM="${WORDLIST}/directory-list-2.3-medium.txt"
  export WL_ROCKYOU="${WORDLIST}/rockyou.txt"
  export WL_LARGEFILES="${WORDLIST}/raft-large-files.txt"
  export WL_XPLATFORM="${WORDLIST}/xplatform.txt"

## [ REVERSE SHELL ]
  export REVSHELL="/usr/local/share/reverse_shell"
  export RS_PATT_NODEJS="${REVSHELL}/patt_nodeJS.js"
  export RS_REVSHELL_PHP="${REVSHELL}/php-reverse-shell.php"
  export RS_WEBSHELL="${REVSHELL}/webshell.php"

## [ IP ADDRESSES ]

  function ipaddr() {
    #### IP addresses will be exported when .egorc is sourced with the
    #### function call, but can also be 'refreshed' when calling ipaddr
    #### from the terminal (ex. after starting a VPN connection).

    #### `host` is provided by the package 'bind'.
    export pubip="$(host myip.opendns.com resolver1.opendns.com               \
                    | grep --color=never -oP '(?<=myip.opendns.com has address ).*$')"

    export locip="$(ip address | grep --color=never -oP "(?<=inet ).*(?=/.*enp)")"
    export vpnip="$(ip address | grep --color=never -oP "(?<=inet ).*(?=/.*tun)")"
  }
  ipaddr

## [ GOTO ]
  #### Requires: bash-completion && sourced in .bashrc
  #### Usage: `goto @mounted`
  #### To add a goto link:
  #### `ln -s /some/directory/path @goto-link` in $HOME/.alterEGO/.goto directory.
  #### src. https://threkk.medium.com/how-to-use-bookmarks-in-bash-zsh-6b8074e40774
  #### src. https://twitter.com/mattn_jp/status/1434192554036137995

  if [ -d "${HOME}/.alterEGO/.goto/" ]; then
    export CDPATH=".:${HOME}/.alterEGO/.goto:/"
    alias goto="cd -P"
    _goto() {
      local IFS=$'\n'
      COMPREPLY=( $(compgen -W "$(/bin/ls ~/.alterEGO/.goto)" -- ${COMP_WORDS[COMP_CWORD]}) )
    } && complete -F _goto goto
  fi

## [ TryHackMe ]

  alias attack=". ${HOME}/.alterEGO/.tryhackmerc"

## [ Damn Vulnerable Web App (DVWA) ]

  function dvwa() {
      #### Will install or run the Damn Vulnerable Web App (DVWA) docker.
      if [[ "$1" == 'start' ]]; then
        sudo systemctl start docker.service
        docker run --rm -it -p 81:80 vulnerables/web-dvwa &
        sleep 2
        $BROWSER "http://localhost:81/login.php"
      elif [[ "$1" == 'stop' ]]; then
        docker stop $(docker ps | grep "vulnerables/web-dvwa" | cut -d ' ' -f1)
        sudo systemctl stop docker.socket
        sudo systemctl stop docker.service
      else
        cat <<EOF
Usage: dvwa start|stop
EOF
      fi
      }

## [ LOADED ]

  function loaded_egorc() {
    printf "${COLOR_GREEN}[+]${COLOR_RESET} ${COLOR_BOLD}.egorc loaded @ $(date | sed 's/  / /g')...${COLOR_RESET}\n"
  }
  loaded_egorc

## [ RELOAD ]

  function reload_egorc() {
    source "${HOME}/.alterEGO/.egorc"
  }

## { FIN }_____________________________________________________________________
