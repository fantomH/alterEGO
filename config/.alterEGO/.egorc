#!/usr/bin/env sh

## { alterEGO Linux: "Open the vault of knowledge" }---------------------------
##
## .egorc
##   created     : 2021-03-19 09:37:19 UTC
##   updated     : 2021-09-14 11:15:36 UTC
##   description : Additional shell stuff for alterEGO Linux.
##   app         : sh
##   target      : ${HOME}/.alterEGO/.egorc
## ____________________________________________________________________________

## [ COLORS ]

  export TERM="xterm-256color"

  export COLOR_ESC=$"\033"
  export COLOR_BLUE="${COLOR_ESC}[34m"
  export COLOR_BOLD="${COLOR_ESC}[1m"
  export COLOR_GREEN="${COLOR_ESC}[32m"
  export COLOR_RED="${COLOR_ESC}[31m"
  export COLOR_RESET="${COLOR_ESC}[0m"

# [ ALIAS ]

  alias msfconsole='msfconsole -x "db_connect ${USER}@msf"'
  alias nmap-basic='sudo grc nmap -sV -O -sC'

## [ DEFAULT APPLICATIONS ]

  export BROWSER=firefox
  export FZF_DEFAULT_COMMAND='rg --files --hidden '
  export TERMINAL="xfce4-terminal --hide-scrollbar --hide-menubar --hide-toolbar"
  export VISUAL=vim
  export EDITOR=${VISUAL}

## [ PATH ]
  #### ref. https://www.linuxjournal.com/content/removing-duplicate-path-entries

  PATH="${PATH}:${HOME}/fH/scripts:${HOME}/droid/scripts:${HOME}/scripts:${HOME}/bin"
  PATH=$(echo -n $PATH | awk -v RS=: '!($0 in a) {a[$0]; printf("%s%s", length(a) > 1 ? ":" : "", $0)}')

  export PATH

## [ VIM ]

  #### Enable CTRL+s and CTRL+q in vim.
  stty -ixon

## [ QT5 ]
  #### https://wiki.manjaro.org/index.php/Set_all_Qt_app%27s_to_use_GTK%2B_font_%26_theme_settings
  #### Set all Qt app's to use GTK+ font & theme settings
  ####   Overview
  ####   When using a Desktop Environment or Window Manager that doesn't allow for the settings of QT themes,
  ####   you can set QT to use your GTK themes instead.
  ####   Using qt5ct
  ####   note: In some Manjaro editions, this is already done for you by default
  ####   Install qt5ct using your favorite package manager or the command:
  ####   pamac install qt5ct
  ####   Set environment variables in ~/.profile by adding or updating the following lines:
  ####   export QT_QPA_PLATFORMTHEME="qt5ct"
  ####   Run the application QT5 Configuration Manager from the menu or run the command qt5ct.
  ####   Logout and login again to make the change effective

  # export QT_QPA_PLATFORMTHEME="qt5ct"

## [ WORDLISTS ]
  export WORDLISTS="/usr/local/share/wordlists"
  export WL_BEST1050="${WORDLISTS}/best1050.txt"
  export WL_BIG="${WORDLISTS}/seclist-big.txt"
  export WL_DIRMEDIUM="${WORDLISTS}/directory-list-2.3-medium.txt"
  export WL_ROCKYOU="${WORDLISTS}/rockyou.txt"
  export WL_LARGEFILES="${WORDLISTS}/raft-large-files.txt"
  export WL_XPLATFORM="${WORDLISTS}/xplatform.txt"

## [ REVERSE SHELL ]
  export REVSHELL="/usr/local/share/reverse_shell"
  export RS_PATT_NODEJS="${REVSHELL}/patt_nodeJS.js"
  export RS_REVSHELL_PHP="${REVSHELL}/php-reverse-shell.php"
  export RS_WEBSHELL="${REVSHELL}/webshell.php"

## [ IP ADDRESSES ]

  function ipaddr() {
    #### IP addresses will be exported when .egorc is sourced with the
    #### function call, but can also be 'refreshed' when calling ipaddr
    #### from the terminal (ex. after starting a VPN connection).

    #### `host` is provided by the package 'bind'.
    export IPPUB="$(host myip.opendns.com resolver1.opendns.com               \
                    | grep --color=never -oP '(?<=myip.opendns.com has address ).*$')"

    export IPLOC="$(ip address | grep --color=never -oP "(?<=inet ).*(?=/.*enp)")"

    # printf "%s\n" "LAN IP:     ${IPLOC}"
    # printf "%s\n" "Public IP:  ${IPPUB}"
  }
  ipaddr

## [ PROMPTS ]

  PROMPT_COMMAND='history -a'

  # export PS1='[\u@\h \W]\$ '
  
  export PS1="\[${COLOR_GREEN}\]\h [\w] • ${SHLVL} • ${locip}\n\[${COLOR_GREEN}\]$ \[${COLOR_RESET}\]"

## [ GOTO ]
  #### Requires: bash-completion && sourced in .bashrc
  #### Usage: `goto @mounted`
  #### To add a goto link:
  #### `ln -s /some/directory/path @goto-link` in $HOME/.alterEGO/.goto directory.
  #### src. https://threkk.medium.com/how-to-use-bookmarks-in-bash-zsh-6b8074e40774
  #### src. https://twitter.com/mattn_jp/status/1434192554036137995

  if [ -d "${HOME}/.alterEGO/.goto/" ]; then
    export CDPATH=".:${HOME}/.alterEGO/.goto:/"
    alias goto="cd -P"
    _goto() {
      local IFS=$'\n'
      COMPREPLY=( $(compgen -W "$(/bin/ls ~/.alterEGO/.goto)" -- ${COMP_WORDS[COMP_CWORD]}) )
    } && complete -F _goto goto
  fi

## [ TryHackMe ]

  alias attack=". ${HOME}/.alterEGO/.tryhackmerc"

## [ Damn Vulnerable Web App (DVWA) ]

  function dvwa() {
      #### Will install or run the Damn Vulnerable Web App (DVWA) docker.
      if [[ "$1" == 'start' ]]; then
        sudo systemctl start docker.service
        docker run --rm -it -p 81:80 vulnerables/web-dvwa &
        sleep 2
        $BROWSER "http://localhost:81/login.php"
      elif [[ "$1" == 'stop' ]]; then
        docker stop $(docker ps | grep "vulnerables/web-dvwa" | cut -d ' ' -f1)
        sudo systemctl stop docker.socket
        sudo systemctl stop docker.service
      else
        cat <<EOF
Usage: dvwa start|stop
EOF
      fi
      }

## [ LOADED ]

  function loaded_egorc() {
    printf "${COLOR_GREEN}[+]${COLOR_RESET} ${COLOR_BOLD}.egorc loaded @ $(date | sed 's/  / /g')...${COLOR_RESET}\n"
  }
  loaded_egorc

## [ RELOAD ]

  function reload_egorc() {
    source "${HOME}/.alterEGO/.egorc"
  }

## { FIN }_____________________________________________________________________
